#coding=utf8
import sys
import os
import db_add
reload(sys)
sys.setdefaultencoding('utf-8')

def get(args):
    sql = 'select miaoji_id , content from old_wiki_en where miaoji_id =%s and content !=\'NULL\''
    return db_add.QueryBySQL(sql,args)

def update(args):
    sql = 'update wiki_en set content=%s where miaoji_id =%s'
    return db_add.ExecuteSQL(sql,args)
b = [ 'v204215', 'v202644', 'v203331', 'v203332', 'v200869', 'v200868', 'v203338', 'v200372', 'v218253', 'v201630', 'v201027', 'v201188', 'v201020', 'v217906', 'v200513', 'v201182', 'v218693', 'v218692', 'v218691', 'v202004', 'v201749', 'v202009', 'v206033', 'v201743', 'v201742', 'v202259', 'v201164', 'v201204', 'v219114', 'v218041', 'v218046', 'v202256', 'v217877', 'v217874', 'v217872', 'v200346', 'v203389', 'v200469', 'v201445', 'v201447', 'v201115', 'v201592', 'v217974', 'v217972', 'v201494', 'v203582', 'v203581', 'v203585', 'v219230', 'v200645', 'v200644', 'v202319', 'v202318', 'v201803', 'v202315', 'v202316', 'v219043', 'v202313', 'v200885', 'v201361', 'v219139', 'v219204', 'v200763', 'v218420', 'v218818', 'v218427', 'v202238', 'v219032', 'v219194', 'v202828', 'v202822', 'v202821', 'v202540', 'v201948', 'v202542', 'v217758', 'v202545', 'v201941', 'v217750', 'v201947', 'v217754', 'v200282', 'v202387', 'v219109', 'v200083', 'v200081', 'v200080', 'v202441', 'v202769', 'v202231', 'v218257', 'v218549', 'v202446', 'v201794', 'v218397', 'v204254', 'v201797', 'v200948', 'v218558', 'v219084', 'v219086', 'v218554', 'v219088', 'v218885', 'v218499', 'v218551', 'v218553', 'v201068', 'v201069', 'v202040', 'v201141', 'v219029', 'v218950', 'v218955', 'v201660', 'v202163', 'v218085', 'v218081', 'v201124', 'v218671', 'v218676', 'v218773', 'v218021', 'v217933', 'v200544', 'v201744', 'v217936', 'v200937', 'v201400', 'v202683', 'v202682', 'v201406', 'v201407', 'v201339', 'v201337', 'v201333', 'v201936', 'v218376', 'v200683', 'v218070', 'v218378', 'v201534', 'v200338', 'v201530', 'v217849', 'v200331', 'v200330', 'v217841', 'v217840', 'v200113', 'v202177', 'v200119', 'v200051', 'v200052', 'v200057', 'v201909', 'v201904', 'v201907', 'v201902', 'v202347', 'v202343', 'v202340', 'v202341', 'v200201', 'v200619', 'v200616', 'v200611', 'v218929', 'v218515', 'v203936', 'v218923', 'v218924', 'v205892', 'v218452', 'v218456', 'v202122', 'v202088', 'v202127', 'v202081', 'v202083', 'v202129', 'v202084', 'v202087', 'v218858', 'v218855', 'v218856', 'v218851', 'v202534', 'v202658', 'v204260', 'v218630', 'v218285', 'v202650', 'v218329', 'v219219', 'v200872', 'v201458', 'v200876', 'v200874', 'v201053', 'v201051', 'v204538', 'v200502', 'v200501', 'v200507', 'v202153', 'v201690', 'v217738', 'v202013', 'v202010', 'v200488', 'v203748', 'v201172', 'v217894', 'v200485', 'v201274', 'v203151', 'v218705', 'v218704', 'v203156', 'v218708', 'v200289', 'v201112', 'v200378', 'v200468', 'v218331', 'v218336', 'v200479', 'v201471', 'v201470', 'v219165', 'v201573', 'v201577', 'v200394', 'v201303', 'v203595', 'v201301', 'v200259', 'v200257', 'v200255', 'v201290', 'v217828', 'v200850', 'v200650', 'v201832', 'v200657', 'v201837', 'v218023', 'v202302', 'v202300', 'v200659', 'v202306', 'v200390', 'v219040', 'v201376', 'v200891', 'v200712', 'v200899', 'v218788', 'v219001', 'v202280', 'v201950', 'v202834', 'v202574', 'v217742', 'v217746', 'v200155', 'v200624', 'v200623', 'v200150', 'v200152', 'v200095', 'v202375', 'v200097', 'v200092', 'v200628', 'v203906', 'v218246', 'v203900', 'v218248', 'v218249', 'v202454', 'v218589', 'v218569', 'v201481', 'v218481', 'v218787', 'v219099', 'v201489', 'v219090', 'v202052', 'v201712', 'v219136', 'v218101', 'v202886', 'v200554', 'v218805', 'v219133', 'v218965', 'v201650', 'v202111', 'v219132', 'v201655', 'v202038', 'v202115', 'v218809', 'v201138', 'v202627', 'v200843', 'v218985', 'v200840', 'v200847', 'v218982', 'v218668', 'v218230', 'v200849', 'v202039', 'v218662', 'v203334', 'v218661', 'v201437', 'v217923', 'v200536', 'v200925', 'v200823', 'v202026', 'v202756', 'v202694', 'v202696', 'v202690', 'v201002', 'v200151', 'v201342', 'v201341', 'v200750', 'v201228', 'v201344', 'v217775', 'v200697', 'v218068', 'v204129', 'v200324', 'v200325', 'v218345', 'v200323', 'v200320', 'v218346', 'v218061', 'v218066', 'v218067', 'v200993', 'v201483', 'v201507', 'v201506', 'v217857', 'v201578', 'v200442', 'v200263', 'v200261', 'v217788', 'v202681', 'v217784', 'v201910', 'v217782', 'v202331', 'v218113', 'v202338', 'v201443', 'v200213', 'v200210', 'v200997', 'v200741', 'v201351', 'v200197', 'v218446', 'v218445', 'v218833', 'v219199', 'v219191', 'v219196', 'v219195', 'v202099', 'v218727', 'v201762', 'v202489', 'v203578', 'v201968', 'v217739', 'v200374', 'v201717', 'v201962', 'v201613', 'v201610', 'v218848', 'v218849', 'v202249', 'v219045', 'v218846', 'v218847', 'v202241', 'v218845', 'v202466', 'v202469', 'v218238', 'v200969', 'v218875', 'v218234', 'v217714', 'v201042', 'v204541', 'v202412', 'v202798', 'v218930', 'v202792', 'v201765', 'v202149', 'v201399', 'v203613', 'v201143', 'v201145', 'v201146', 'v201260', 'v203751', 'v201264', 'v202113', 'v218653', 'v200796', 'v200795', 'v218964', 'v203167', 'v218659', 'v217811', 'v217819', 'v200816', 'v203363', 'v200365', 'v200564', 'v218469', 'v200567', 'v218652', 'v200384', 'v200386', 'v200291', 'v200382', 'v200220', 'v201455', 'v201389', 'v200317', 'v201385', 'v200314', 'v201382', 'v201380', 'v202298', 'v202299', 'v200134', 'v201544', 'v218401', 'v200032', 'v219152', 'v200139', 'v202809', 'v217774', 'v202395', 'v202201', 'v202532', 'v202209', 'v200143', 'v219129', 'v202369', 'v219122', 'v217766', 'v217866', 'v200360', 'v218635', 'v202428', 'v200845', 'v202423', 'v202422', 'v202421', 'v218903', 'v218900', 'v201647', 'v201729', 'v201643', 'v218632', 'v201721', 'v201649', 'v202109', 'v218979', 'v218877', 'v219010', 'v202517', 'v218973', 'v202102', 'v202105', 'v218974', 'v219019', 'v202735', 'v218961', 'v218759', 'v202631', 'v218994', 'v204208', 'v218618', 'v204205', 'v204207', 'v201420', 'v217918', 'v201424', 'v201425', 'v200911', 'v200529', 'v217910', 'v217913', 'v202034', 'v202746', 'v202032', 'v202749', 'v201035', 'v201034', 'v201037', 'v201358', 'v201359', 'v201217', 'v203483', 'v201352', 'v201862', 'v218726', 'v218250', 'v201865', 'v201972', 'v218295', 'v218292', 'v202754', 'v218254', 'v218352', 'v200294', 'v201107', 'v201516', 'v217863', 'v217989', 'v201512', 'v200598', 'v201510', 'v200453', 'v200274', 'v200275', 'v200179', 'v200178', 'v202764', 'v200176', 'v201004', 'v200187', 'v200183', 'v201811', 'v200188', 'v200779', 'v218491', 'v201496', 'v218431', 'v200003', 'v200002', 'v200001', 'v218532', 'v218825', 'v219025', 'v218438', 'v219022', 'v219021', 'v218886', 'v201974', 'v202491', 'v217722', 'v201971', 'v202494', 'v218498', 'v219113', 'v200071', 'v219116', 'v201562', 'v202255', 'v219119', 'v202257', 'v219057', 'v218685', 'v218224', 'v202471', 'v202775', 'v201700', 'v200959', 'v218897', 'v218548', 'v218547', 'v218898', 'v200956', 'v200951', 'v201777', 'v202782', 'v201874', 'v202079', 'v202173', 'v202175', 'v201679', 'v202070', 'v218948', 'v201670', 'v202605', 'v201326', 'v201154', 'v201151', 'v218768', 'v218314', 'v218761', 'v218096', 'v200829', 'v217947', 'v201550', 'v217829', 'v200415', 'v201554', 'v217825', 'v217827', 'v200824', 'v217948', 'v217949', 'v201419', 'v218533', 'v200550', 'v200553', 'v201410', 'v201416', 'v201415', 'v201321', 'v201325', 'v218913', 'v201632', 'v201329', 'v200235', 'v218829', 'v201739', 'v204285', 'v218365', 'v200736', 'v218361', 'v218360', 'v201853', 'v218004', 'v201634', 'v201857', 'v201854', 'v200945', 'v200309', 'v200284', 'v201394', 'v203154', 'v201730', 'v200303', 'v200049', 'v201731', 'v200122', 'v200040', 'v219141', 'v217760', 'v202183', 'v202184', 'v200283', 'v217764', 'v201885', 'v201939', 'v217769', 'v202210', 'v203421', 'v219158', 'v200601', 'v200606', 'v202351', 'v202353', 'v202354', 'v218501', 'v218269', 'v217993', 'v217850', 'v204323', 'v202295', 'v200030', 'v218465', 'v218466', 'v217717', 'v217716', 'v202137', 'v203258', 'v202131', 'v201982', 'v203252', 'v201639', 'v201281', 'v201734', 'v219062', 'v219060', 'v202508', 'v200806']

if __name__ in '__main__':
    c1,c2 = 0,0
    for j in b:
        print j
        for i in get(j):
            mid = i['miaoji_id']
            co = i['content']
            try:
                print 'update',update((co,mid)),mid
                print '----',mid
                c1 +=1
            except:
                print 'error',mid
                c2+=1
    print 'all',len(b)
    print 'ok',c1
    print 'no ok',c2
